 name: Install Supabase CLI
  run: |
    npm install supabase --save-dev
    export PATH="$PATH:$(pwd)/node_modules/.bin"
    npx supabase --version || echo "Supabase CLI installation verification failed but continuing..."

# Removed "Supabase Login" step

 name: Link to Supabase project
  run: |
    export PATH="$PATH:$(pwd)/node_modules/.bin"
    if [ -z "$(find . -name 'supabase' -type d)" ]; then
      npx supabase init
    fi
    npx supabase link --project-ref $PROJECT_ID --password $SUPABASE_DB_PASSWORD

 name: Push Supabase migrations
  run: |
    export PATH="$PATH:$(pwd)/node_modules/.bin"
    npx supabase db push
